<template name="transaction">
  <div id="feedItem-{{contract._id}}" class="vote vote-delegation vote-feed vote-search {{onCard}} w-clearfix">
    {{#if compressed}}
      <div class="identity identity-transaction w-clearfix" style="float:left">
        {{#with sender}}
          {{> avatar size=32 profile=this._id includeName=false includeNation=false editable=false microFont=true disabled=true includeRole=false imgStyle=this.imgStyle}}
        {{/with}}
      </div>
      <div style="float:left">
        <img src="{{pathFor route='home'}}images/arrow-right.png" class="transaction-direction" style="margin-top: 3px; ">
      </div>
      <div class="identity identity-transaction w-clearfix" style="float:left">
        {{#with receiver}}
          {{> avatar size=32 profile=this._id includeName=false includeNation=false editable=false microFont=true disabled=true includeRole=false imgStyle=this.imgStyle}}}
        {{/with}}
      </div>
    {{else}}
      {{#if isVote}}
        <table class="transaction-data w-clearfix">
          <tr>
            {{#if isRevoke}}
              {{#if isSubsidy}}
                {{> collectivePreview collectiveId=this.senderId}}
              {{else}}
                <td class="actor">
                  <div class="actor actor-score actor-score-ballot">
                    <div class="transaction-value">
                      <div class="bar-labels">
                        <div class="vote-available label-votes">
                          <div class="stage stage-vote {{revokeStyle}} {{loosing}}">
                            <div class="label label-corner">
                              <div class="checkbox-mini">
                                <div class="checkmark_kick"></div>
                                <div class="checkmark_stem"></div>
                              </div>
                              {{ballotOption}}
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  {{#unless hidePost}}
                    {{> preview contractId=this.senderId}}
                  {{/unless}}
                </td>
              {{/if}}
            {{else}}
              <td class="actor">
                <div class="identity identity-transaction w-clearfix">
                  {{#with sender}}
                    {{> avatar size=24 profile=this._id includeName=true includeNation=true editable=false microFont=true disabled=false includeRole=false flex=true}}
                  {{/with}}
                </div>
              </td>
            {{/if}}
            <td class="actor actor-arrow">
              <img src="{{pathFor route='home'}}images/arrow-right.png" class="transaction-direction">
            </td>
            {{#if isRevoke}}
              <td class="actor">
                <div class="identity identity-transaction w-clearfix">
                  {{#with receiver}}
                    {{> avatar size=24 profile=this._id includeName=true includeNation=true editable=false microFont=true disabled=false includeRole=false flex=true}}
                  {{/with}}
                </div>
              </td>
            {{else}}
              {{#unless isSubsidy}}
                <td class="actor">
                  <div class="actor actor-score actor-score-ballot">
                    <div class="transaction-value">
                      <div class="bar-labels">
                        <div class="vote-available label-votes">
                          <div class="stage stage-vote {{stage}}">
                            <div class="label label-corner">
                              <div class="checkbox-mini">
                                <div class="checkmark_kick"></div>
                                <div class="checkmark_stem"></div>
                              </div>
                              {{ballotOption}}
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </td>
                {{#unless hidePost}}
                  {{> preview contractId=this.receiverId}}
                {{/unless}}
              {{/unless}}
            {{/if}}
          </tr>
        </table>
      {{else}}
        <table class="transaction-data w-clearfix">
          <tr>
            <td class="actor">
              <div class="identity identity-transaction w-clearfix">
                {{#with sender}}
                  {{> avatar size=24 profile=this._id includeName=true includeNation=true editable=false microFont=true disabled=false includeRole=false flex=true}}
                {{/with}}
              </div>
            </td>
            <td class="actor actor-arrow">
              <img src="{{pathFor route='home'}}images/arrow-right.png" class="transaction-direction">
            </td>
            <td class="actor">
              <div class="identity identity-transaction w-clearfix">
                {{#with receiver}}
                  {{> avatar size=24 profile=this._id includeName=true includeNation=true editable=false microFont=true disabled=false includeRole=false flex=true}}
                {{/with}}
              </div>
            </td>
          </tr>
        </table>
      {{/if}}
    {{/if}}
    {{#unless noDate}}
      <div class="data data-feed data-transaction">
        <div class="verifier verifier-live verifier-feed">&#183; {{sinceDate}}</div>
      </div>
    {{/unless}}
    <div class="actor actor-score">
      <div class="transaction-value">
        <div class="bar-labels">
          <div class="vote-available label-votes">
            <div class="{{voteStyle}}">
              <div class="label label-corner">
                {{value}}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<template name="collectivePreview">
  <td class="actor">
    <div class="identity identity-transaction w-clearfix">
      <img class="collective-icon collective-icon-small" src="{{pathFor route='home'}}{{flag}}">
    </div>
  </td>
  <td class="actor">
    <div class="identity identity-transaction w-clearfix">
      <div class="identity-peer">
        <a href="{{url}}" class="identity-label identity-label-micro">
          {{name}}
        </a>
      </div>
    </div>
  </td>
</template>
